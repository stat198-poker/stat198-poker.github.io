{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { initializeComponentRef, EventGroup, css, shallowCompare, getNativeProps, divProperties } from '../../Utilities';\nimport { CheckboxVisibility } from './DetailsList.types';\nimport { DetailsRowCheck } from './DetailsRowCheck';\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\nimport { DetailsRowFields } from './DetailsRowFields';\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\nimport { SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\nimport { CollapseAllVisibility } from '../../GroupedList';\nimport { classNamesFunction } from '../../Utilities';\nvar getClassNames = classNamesFunction();\nvar DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\nvar NO_COLUMNS = [];\n\nvar DetailsRowBase =\n/** @class */\nfunction (_super) {\n  __extends(DetailsRowBase, _super);\n\n  function DetailsRowBase(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this._cellMeasurer = React.createRef();\n    _this._focusZone = React.createRef();\n\n    _this._onSelectionChanged = function () {\n      var selectionState = _this._getSelectionState(_this.props);\n\n      if (!shallowCompare(selectionState, _this.state.selectionState)) {\n        _this.setState({\n          selectionState: selectionState\n        });\n      }\n    };\n\n    _this._onRootRef = function (focusZone) {\n      if (focusZone) {\n        // Need to resolve the actual DOM node, not the component.\n        // The element itself will be used for drag/drop and focusing.\n        _this._root = ReactDOM.findDOMNode(focusZone);\n      } else {\n        _this._root = undefined;\n      }\n    };\n    /**\n     * update isDropping state based on the input value, which is used to change style during drag and drop\n     *\n     * when change to true, that means drag enter. we will add default dropping class name\n     * or the custom dropping class name (return result from onDragEnter) to the root elemet.\n     *\n     * when change to false, that means drag leave. we will remove the dropping class name from root element.\n     *\n     * @param newValue - New isDropping state value\n     * @param event - The event trigger dropping state change which can be dragenter, dragleave etc\n     */\n\n\n    _this._updateDroppingState = function (newValue, event) {\n      var isDropping = _this.state.isDropping;\n      var _a = _this.props,\n          dragDropEvents = _a.dragDropEvents,\n          item = _a.item;\n\n      if (!newValue) {\n        if (dragDropEvents.onDragLeave) {\n          dragDropEvents.onDragLeave(item, event);\n        }\n      } else if (dragDropEvents.onDragEnter) {\n        _this._droppingClassNames = dragDropEvents.onDragEnter(item, event);\n      }\n\n      if (isDropping !== newValue) {\n        _this.setState({\n          isDropping: newValue\n        });\n      }\n    };\n\n    initializeComponentRef(_this);\n    _this._events = new EventGroup(_this);\n    _this.state = {\n      selectionState: _this._getSelectionState(props),\n      columnMeasureInfo: undefined,\n      isDropping: false\n    };\n    _this._droppingClassNames = '';\n    return _this;\n  }\n\n  DetailsRowBase.prototype.componentDidMount = function () {\n    var dragDropHelper = this.props.dragDropHelper;\n\n    if (dragDropHelper) {\n      this._dragDropSubscription = dragDropHelper.subscribe(this._root, this._events, this._getRowDragDropOptions());\n    }\n\n    this._events.on(this.props.selection, SELECTION_CHANGE, this._onSelectionChanged);\n\n    if (this.props.onDidMount && this.props.item) {\n      // If the item appears later, we should wait for it before calling this method.\n      this._onDidMountCalled = true;\n      this.props.onDidMount(this);\n    }\n  };\n\n  DetailsRowBase.prototype.componentDidUpdate = function (previousProps) {\n    var state = this.state;\n    var _a = this.props,\n        item = _a.item,\n        onDidMount = _a.onDidMount;\n    var columnMeasureInfo = state.columnMeasureInfo;\n\n    if (this.props.itemIndex !== previousProps.itemIndex || this.props.item !== previousProps.item || this.props.dragDropHelper !== previousProps.dragDropHelper) {\n      if (this._dragDropSubscription) {\n        this._dragDropSubscription.dispose();\n\n        delete this._dragDropSubscription;\n      }\n\n      if (this.props.dragDropHelper) {\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(this._root, this._events, this._getRowDragDropOptions());\n      }\n    }\n\n    if (columnMeasureInfo && columnMeasureInfo.index >= 0 && this._cellMeasurer.current) {\n      var newWidth = this._cellMeasurer.current.getBoundingClientRect().width;\n\n      columnMeasureInfo.onMeasureDone(newWidth);\n      this.setState({\n        columnMeasureInfo: undefined\n      });\n    }\n\n    if (item && onDidMount && !this._onDidMountCalled) {\n      this._onDidMountCalled = true;\n      onDidMount(this);\n    }\n  };\n\n  DetailsRowBase.prototype.componentWillUnmount = function () {\n    var _a = this.props,\n        item = _a.item,\n        onWillUnmount = _a.onWillUnmount; // Only call the onWillUnmount callback if we have an item.\n\n    if (onWillUnmount && item) {\n      onWillUnmount(this);\n    }\n\n    if (this._dragDropSubscription) {\n      this._dragDropSubscription.dispose();\n\n      delete this._dragDropSubscription;\n    }\n\n    this._events.dispose();\n  }; // tslint:disable-next-line function-name\n\n\n  DetailsRowBase.prototype.UNSAFE_componentWillReceiveProps = function (newProps) {\n    this.setState({\n      selectionState: this._getSelectionState(newProps)\n    });\n  };\n\n  DetailsRowBase.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n    if (this.props.useReducedRowRenderer) {\n      var newSelectionState = this._getSelectionState(nextProps);\n\n      if (this.state.selectionState.isSelected !== newSelectionState.isSelected) {\n        return true;\n      }\n\n      return !shallowCompare(this.props, nextProps);\n    } else {\n      return true;\n    }\n  };\n\n  DetailsRowBase.prototype.render = function () {\n    var _a = this.props,\n        className = _a.className,\n        _b = _a.columns,\n        columns = _b === void 0 ? NO_COLUMNS : _b,\n        dragDropEvents = _a.dragDropEvents,\n        item = _a.item,\n        itemIndex = _a.itemIndex,\n        _c = _a.onRenderCheck,\n        onRenderCheck = _c === void 0 ? this._onRenderCheck : _c,\n        onRenderDetailsCheckbox = _a.onRenderDetailsCheckbox,\n        onRenderItemColumn = _a.onRenderItemColumn,\n        getCellValueKey = _a.getCellValueKey,\n        selectionMode = _a.selectionMode,\n        _d = _a.rowWidth,\n        rowWidth = _d === void 0 ? 0 : _d,\n        checkboxVisibility = _a.checkboxVisibility,\n        getRowAriaLabel = _a.getRowAriaLabel,\n        getRowAriaDescribedBy = _a.getRowAriaDescribedBy,\n        checkButtonAriaLabel = _a.checkButtonAriaLabel,\n        checkboxCellClassName = _a.checkboxCellClassName,\n\n    /** Alias rowFieldsAs as RowFields and default to DetailsRowFields if rowFieldsAs does not exist */\n    _e = _a.rowFieldsAs,\n\n    /** Alias rowFieldsAs as RowFields and default to DetailsRowFields if rowFieldsAs does not exist */\n    RowFields = _e === void 0 ? DetailsRowFields : _e,\n        selection = _a.selection,\n        indentWidth = _a.indentWidth,\n        enableUpdateAnimations = _a.enableUpdateAnimations,\n        compact = _a.compact,\n        theme = _a.theme,\n        styles = _a.styles,\n        cellsByColumn = _a.cellsByColumn,\n        groupNestingDepth = _a.groupNestingDepth,\n        _f = _a.useFastIcons,\n        useFastIcons = _f === void 0 ? true : _f,\n        cellStyleProps = _a.cellStyleProps;\n    var _g = this.state,\n        columnMeasureInfo = _g.columnMeasureInfo,\n        isDropping = _g.isDropping;\n    var _h = this.state.selectionState,\n        _j = _h.isSelected,\n        isSelected = _j === void 0 ? false : _j,\n        _k = _h.isSelectionModal,\n        isSelectionModal = _k === void 0 ? false : _k;\n    var isDraggable = dragDropEvents ? !!(dragDropEvents.canDrag && dragDropEvents.canDrag(item)) : undefined;\n    var droppingClassName = isDropping ? this._droppingClassNames || DEFAULT_DROPPING_CSS_CLASS : '';\n    var ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : undefined;\n    var ariaDescribedBy = getRowAriaDescribedBy ? getRowAriaDescribedBy(item) : undefined;\n    var canSelect = !!selection && selection.canSelectItem(item, itemIndex);\n    var isContentUnselectable = selectionMode === SelectionMode.multiple;\n    var showCheckbox = selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden;\n    var ariaSelected = selectionMode === SelectionMode.none ? undefined : isSelected;\n    this._classNames = __assign(__assign({}, this._classNames), getClassNames(styles, {\n      theme: theme,\n      isSelected: isSelected,\n      canSelect: !isContentUnselectable,\n      anySelected: isSelectionModal,\n      checkboxCellClassName: checkboxCellClassName,\n      droppingClassName: droppingClassName,\n      className: className,\n      compact: compact,\n      enableUpdateAnimations: enableUpdateAnimations,\n      cellStyleProps: cellStyleProps\n    }));\n    var rowClassNames = {\n      isMultiline: this._classNames.isMultiline,\n      isRowHeader: this._classNames.isRowHeader,\n      cell: this._classNames.cell,\n      cellAnimation: this._classNames.cellAnimation,\n      cellPadded: this._classNames.cellPadded,\n      cellUnpadded: this._classNames.cellUnpadded,\n      fields: this._classNames.fields\n    }; // Only re-assign rowClassNames when classNames have changed.\n    // Otherwise, they will cause DetailsRowFields to unnecessarily\n    // re-render, see https://github.com/microsoft/fluentui/pull/8799.\n    // Refactor DetailsRowFields to generate own styles to remove need for this.\n\n    if (!shallowCompare(this._rowClassNames || {}, rowClassNames)) {\n      this._rowClassNames = rowClassNames;\n    }\n\n    var rowFields = React.createElement(RowFields, {\n      rowClassNames: this._rowClassNames,\n      cellsByColumn: cellsByColumn,\n      columns: columns,\n      item: item,\n      itemIndex: itemIndex,\n      columnStartIndex: showCheckbox ? 1 : 0,\n      onRenderItemColumn: onRenderItemColumn,\n      getCellValueKey: getCellValueKey,\n      enableUpdateAnimations: enableUpdateAnimations,\n      cellStyleProps: cellStyleProps\n    });\n    return React.createElement(FocusZone, __assign({\n      \"data-is-focusable\": true\n    }, getNativeProps(this.props, divProperties), typeof isDraggable === 'boolean' ? {\n      'data-is-draggable': isDraggable,\n      draggable: isDraggable\n    } : {}, {\n      direction: FocusZoneDirection.horizontal,\n      ref: this._onRootRef,\n      componentRef: this._focusZone,\n      role: \"row\",\n      \"aria-label\": ariaLabel,\n      \"aria-describedby\": ariaDescribedBy,\n      className: this._classNames.root,\n      \"data-selection-index\": itemIndex,\n      \"data-selection-touch-invoke\": true,\n      \"data-item-index\": itemIndex,\n      \"aria-rowindex\": itemIndex + 1,\n      \"data-automationid\": \"DetailsRow\",\n      style: {\n        minWidth: rowWidth\n      },\n      \"aria-selected\": ariaSelected,\n      allowFocusRoot: true\n    }), showCheckbox && React.createElement(\"div\", {\n      role: \"gridcell\",\n      \"aria-colindex\": 1,\n      \"data-selection-toggle\": true,\n      className: this._classNames.checkCell\n    }, onRenderCheck({\n      selected: isSelected,\n      anySelected: isSelectionModal,\n      'aria-label': checkButtonAriaLabel,\n      canSelect: canSelect,\n      compact: compact,\n      className: this._classNames.check,\n      theme: theme,\n      isVisible: checkboxVisibility === CheckboxVisibility.always,\n      onRenderDetailsCheckbox: onRenderDetailsCheckbox,\n      useFastIcons: useFastIcons\n    })), React.createElement(GroupSpacer, {\n      indentWidth: indentWidth,\n      count: groupNestingDepth - (this.props.collapseAllVisibility === CollapseAllVisibility.hidden ? 1 : 0)\n    }), item && rowFields, columnMeasureInfo && React.createElement(\"span\", {\n      role: \"presentation\",\n      className: css(this._classNames.cellMeasurer, this._classNames.cell),\n      ref: this._cellMeasurer\n    }, React.createElement(RowFields, {\n      rowClassNames: this._rowClassNames,\n      columns: [columnMeasureInfo.column],\n      item: item,\n      itemIndex: itemIndex,\n      columnStartIndex: (showCheckbox ? 1 : 0) + columns.length,\n      onRenderItemColumn: onRenderItemColumn,\n      getCellValueKey: getCellValueKey\n    })), React.createElement(\"span\", {\n      role: \"checkbox\",\n      className: this._classNames.checkCover,\n      \"aria-checked\": isSelected,\n      \"data-selection-toggle\": true\n    }));\n  };\n  /**\n   * measure cell at index. and call the call back with the measured cell width when finish measure\n   *\n   * @param index - The cell index\n   * @param onMeasureDone - The call back function when finish measure\n   */\n\n\n  DetailsRowBase.prototype.measureCell = function (index, onMeasureDone) {\n    var _a = this.props.columns,\n        columns = _a === void 0 ? NO_COLUMNS : _a;\n\n    var column = __assign({}, columns[index]);\n\n    column.minWidth = 0;\n    column.maxWidth = 999999;\n    delete column.calculatedWidth;\n    this.setState({\n      columnMeasureInfo: {\n        index: index,\n        column: column,\n        onMeasureDone: onMeasureDone\n      }\n    });\n  };\n\n  DetailsRowBase.prototype.focus = function (forceIntoFirstElement) {\n    if (forceIntoFirstElement === void 0) {\n      forceIntoFirstElement = false;\n    }\n\n    return !!this._focusZone.current && this._focusZone.current.focus(forceIntoFirstElement);\n  };\n\n  DetailsRowBase.prototype._onRenderCheck = function (props) {\n    return React.createElement(DetailsRowCheck, __assign({}, props));\n  };\n\n  DetailsRowBase.prototype._getSelectionState = function (props) {\n    var itemIndex = props.itemIndex,\n        selection = props.selection;\n    return {\n      isSelected: !!selection && selection.isIndexSelected(itemIndex),\n      isSelectionModal: !!selection && !!selection.isModal && selection.isModal()\n    };\n  };\n\n  DetailsRowBase.prototype._getRowDragDropOptions = function () {\n    var _a = this.props,\n        item = _a.item,\n        itemIndex = _a.itemIndex,\n        dragDropEvents = _a.dragDropEvents,\n        eventsToRegister = _a.eventsToRegister;\n    var options = {\n      eventMap: eventsToRegister,\n      selectionIndex: itemIndex,\n      context: {\n        data: item,\n        index: itemIndex\n      },\n      canDrag: dragDropEvents.canDrag,\n      canDrop: dragDropEvents.canDrop,\n      onDragStart: dragDropEvents.onDragStart,\n      updateDropState: this._updateDroppingState,\n      onDrop: dragDropEvents.onDrop,\n      onDragEnd: dragDropEvents.onDragEnd,\n      onDragOver: dragDropEvents.onDragOver\n    };\n    return options;\n  };\n\n  return DetailsRowBase;\n}(React.Component);\n\nexport { DetailsRowBase };","map":{"version":3,"sources":["components/DetailsList/DetailsRow.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport {\n  initializeComponentRef,\n  EventGroup,\n  IDisposable,\n  css,\n  shallowCompare,\n  getNativeProps,\n  divProperties,\n} from '../../Utilities';\nimport { IColumn, CheckboxVisibility } from './DetailsList.types';\nimport { DetailsRowCheck } from './DetailsRowCheck';\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\nimport { DetailsRowFields } from './DetailsRowFields';\nimport { FocusZone, FocusZoneDirection, IFocusZone } from '../../FocusZone';\nimport { SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\nimport { CollapseAllVisibility } from '../../GroupedList';\nimport { IDragDropOptions } from './../../utilities/dragdrop/interfaces';\nimport { IDetailsRowBaseProps } from './DetailsRow.types';\nimport { IDetailsRowCheckProps } from './DetailsRowCheck.types';\nimport { IDetailsRowStyleProps, IDetailsRowStyles } from './DetailsRow.types';\nimport { classNamesFunction } from '../../Utilities';\nimport { IDetailsRowFieldsProps } from './DetailsRowFields.types';\nimport { IProcessedStyleSet } from '../../Styling';\n\nconst getClassNames = classNamesFunction<IDetailsRowStyleProps, IDetailsRowStyles>();\n\nexport interface IDetailsRowSelectionState {\n  isSelected: boolean;\n  isSelectionModal: boolean;\n}\n\nexport interface IDetailsRowState {\n  selectionState: IDetailsRowSelectionState;\n  columnMeasureInfo?: {\n    index: number;\n    column: IColumn;\n    onMeasureDone: (measuredWidth: number) => void;\n  };\n  isDropping?: boolean;\n}\n\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\n\nconst NO_COLUMNS: IColumn[] = [];\n\nexport class DetailsRowBase extends React.Component<IDetailsRowBaseProps, IDetailsRowState> {\n  private _events: EventGroup;\n  private _root: HTMLElement | undefined;\n  private _cellMeasurer = React.createRef<HTMLSpanElement>();\n  private _focusZone = React.createRef<IFocusZone>();\n  private _droppingClassNames: string;\n  /** Whether this.props.onDidMount has been called */\n  private _onDidMountCalled: boolean;\n  private _dragDropSubscription: IDisposable;\n\n  private _classNames: IProcessedStyleSet<IDetailsRowStyles>;\n  private _rowClassNames: IDetailsRowFieldsProps['rowClassNames'];\n\n  constructor(props: IDetailsRowBaseProps) {\n    super(props);\n\n    initializeComponentRef(this);\n    this._events = new EventGroup(this);\n\n    this.state = {\n      selectionState: this._getSelectionState(props),\n      columnMeasureInfo: undefined,\n      isDropping: false,\n    };\n\n    this._droppingClassNames = '';\n  }\n\n  public componentDidMount(): void {\n    const { dragDropHelper } = this.props;\n\n    if (dragDropHelper) {\n      this._dragDropSubscription = dragDropHelper.subscribe(\n        this._root as HTMLElement,\n        this._events,\n        this._getRowDragDropOptions(),\n      );\n    }\n\n    this._events.on(this.props.selection, SELECTION_CHANGE, this._onSelectionChanged);\n\n    if (this.props.onDidMount && this.props.item) {\n      // If the item appears later, we should wait for it before calling this method.\n      this._onDidMountCalled = true;\n      this.props.onDidMount(this);\n    }\n  }\n\n  public componentDidUpdate(previousProps: IDetailsRowBaseProps) {\n    const state = this.state;\n    const { item, onDidMount } = this.props;\n    const { columnMeasureInfo } = state;\n\n    if (\n      this.props.itemIndex !== previousProps.itemIndex ||\n      this.props.item !== previousProps.item ||\n      this.props.dragDropHelper !== previousProps.dragDropHelper\n    ) {\n      if (this._dragDropSubscription) {\n        this._dragDropSubscription.dispose();\n        delete this._dragDropSubscription;\n      }\n\n      if (this.props.dragDropHelper) {\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(\n          this._root as HTMLElement,\n          this._events,\n          this._getRowDragDropOptions(),\n        );\n      }\n    }\n\n    if (columnMeasureInfo && columnMeasureInfo.index >= 0 && this._cellMeasurer.current) {\n      const newWidth = this._cellMeasurer.current.getBoundingClientRect().width;\n\n      columnMeasureInfo.onMeasureDone(newWidth);\n\n      this.setState({\n        columnMeasureInfo: undefined,\n      });\n    }\n\n    if (item && onDidMount && !this._onDidMountCalled) {\n      this._onDidMountCalled = true;\n      onDidMount(this);\n    }\n  }\n\n  public componentWillUnmount(): void {\n    const { item, onWillUnmount } = this.props;\n\n    // Only call the onWillUnmount callback if we have an item.\n    if (onWillUnmount && item) {\n      onWillUnmount(this);\n    }\n\n    if (this._dragDropSubscription) {\n      this._dragDropSubscription.dispose();\n      delete this._dragDropSubscription;\n    }\n\n    this._events.dispose();\n  }\n\n  // tslint:disable-next-line function-name\n  public UNSAFE_componentWillReceiveProps(newProps: IDetailsRowBaseProps): void {\n    this.setState({\n      selectionState: this._getSelectionState(newProps),\n    });\n  }\n\n  public shouldComponentUpdate(nextProps: IDetailsRowBaseProps, nextState: IDetailsRowState): boolean {\n    if (this.props.useReducedRowRenderer) {\n      const newSelectionState = this._getSelectionState(nextProps);\n      if (this.state.selectionState.isSelected !== newSelectionState.isSelected) {\n        return true;\n      }\n      return !shallowCompare(this.props, nextProps);\n    } else {\n      return true;\n    }\n  }\n\n  public render(): JSX.Element {\n    const {\n      className,\n      columns = NO_COLUMNS,\n      dragDropEvents,\n      item,\n      itemIndex,\n      onRenderCheck = this._onRenderCheck,\n      onRenderDetailsCheckbox,\n      onRenderItemColumn,\n      getCellValueKey,\n      selectionMode,\n      rowWidth = 0,\n      checkboxVisibility,\n      getRowAriaLabel,\n      getRowAriaDescribedBy,\n      checkButtonAriaLabel,\n      checkboxCellClassName,\n      /** Alias rowFieldsAs as RowFields and default to DetailsRowFields if rowFieldsAs does not exist */\n      rowFieldsAs: RowFields = DetailsRowFields,\n      selection,\n      indentWidth,\n      enableUpdateAnimations,\n      compact,\n      theme,\n      styles,\n      cellsByColumn,\n      groupNestingDepth,\n      useFastIcons = true,\n      cellStyleProps,\n    } = this.props;\n    const { columnMeasureInfo, isDropping } = this.state;\n    const { isSelected = false, isSelectionModal = false } = this.state.selectionState;\n    const isDraggable = dragDropEvents ? !!(dragDropEvents.canDrag && dragDropEvents.canDrag(item)) : undefined;\n    const droppingClassName = isDropping ? this._droppingClassNames || DEFAULT_DROPPING_CSS_CLASS : '';\n    const ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : undefined;\n    const ariaDescribedBy = getRowAriaDescribedBy ? getRowAriaDescribedBy(item) : undefined;\n    const canSelect = !!selection && selection.canSelectItem(item, itemIndex);\n    const isContentUnselectable = selectionMode === SelectionMode.multiple;\n    const showCheckbox = selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden;\n    const ariaSelected = selectionMode === SelectionMode.none ? undefined : isSelected;\n\n    this._classNames = {\n      ...this._classNames,\n      ...getClassNames(styles, {\n        theme: theme!,\n        isSelected,\n        canSelect: !isContentUnselectable,\n        anySelected: isSelectionModal,\n        checkboxCellClassName,\n        droppingClassName,\n        className,\n        compact,\n        enableUpdateAnimations,\n        cellStyleProps,\n      }),\n    };\n\n    const rowClassNames: IDetailsRowFieldsProps['rowClassNames'] = {\n      isMultiline: this._classNames.isMultiline,\n      isRowHeader: this._classNames.isRowHeader,\n      cell: this._classNames.cell,\n      cellAnimation: this._classNames.cellAnimation,\n      cellPadded: this._classNames.cellPadded,\n      cellUnpadded: this._classNames.cellUnpadded,\n      fields: this._classNames.fields,\n    };\n\n    // Only re-assign rowClassNames when classNames have changed.\n    // Otherwise, they will cause DetailsRowFields to unnecessarily\n    // re-render, see https://github.com/microsoft/fluentui/pull/8799.\n    // Refactor DetailsRowFields to generate own styles to remove need for this.\n    if (!shallowCompare(this._rowClassNames || {}, rowClassNames)) {\n      this._rowClassNames = rowClassNames;\n    }\n\n    const rowFields = (\n      <RowFields\n        rowClassNames={this._rowClassNames}\n        cellsByColumn={cellsByColumn}\n        columns={columns}\n        item={item}\n        itemIndex={itemIndex}\n        columnStartIndex={showCheckbox ? 1 : 0}\n        onRenderItemColumn={onRenderItemColumn}\n        getCellValueKey={getCellValueKey}\n        enableUpdateAnimations={enableUpdateAnimations}\n        cellStyleProps={cellStyleProps}\n      />\n    );\n\n    return (\n      <FocusZone\n        data-is-focusable={true}\n        {...getNativeProps(this.props, divProperties)}\n        {...(typeof isDraggable === 'boolean'\n          ? {\n              'data-is-draggable': isDraggable, // This data attribute is used by some host applications.\n              draggable: isDraggable,\n            }\n          : {})}\n        direction={FocusZoneDirection.horizontal}\n        ref={this._onRootRef}\n        componentRef={this._focusZone}\n        role=\"row\"\n        aria-label={ariaLabel}\n        aria-describedby={ariaDescribedBy}\n        className={this._classNames.root}\n        data-selection-index={itemIndex}\n        data-selection-touch-invoke={true}\n        data-item-index={itemIndex}\n        aria-rowindex={itemIndex + 1}\n        data-automationid=\"DetailsRow\"\n        style={{ minWidth: rowWidth }}\n        aria-selected={ariaSelected}\n        allowFocusRoot={true}\n      >\n        {showCheckbox && (\n          <div role=\"gridcell\" aria-colindex={1} data-selection-toggle={true} className={this._classNames.checkCell}>\n            {onRenderCheck({\n              selected: isSelected,\n              anySelected: isSelectionModal,\n              'aria-label': checkButtonAriaLabel,\n              canSelect,\n              compact,\n              className: this._classNames.check,\n              theme,\n              isVisible: checkboxVisibility === CheckboxVisibility.always,\n              onRenderDetailsCheckbox: onRenderDetailsCheckbox,\n              useFastIcons,\n            })}\n          </div>\n        )}\n\n        <GroupSpacer\n          indentWidth={indentWidth}\n          count={groupNestingDepth! - (this.props.collapseAllVisibility === CollapseAllVisibility.hidden ? 1 : 0)}\n        />\n\n        {item && rowFields}\n        {columnMeasureInfo && (\n          <span\n            role=\"presentation\"\n            className={css(this._classNames.cellMeasurer, this._classNames.cell)}\n            ref={this._cellMeasurer}\n          >\n            <RowFields\n              rowClassNames={this._rowClassNames}\n              columns={[columnMeasureInfo.column]}\n              item={item}\n              itemIndex={itemIndex}\n              columnStartIndex={(showCheckbox ? 1 : 0) + columns.length}\n              onRenderItemColumn={onRenderItemColumn}\n              getCellValueKey={getCellValueKey}\n            />\n          </span>\n        )}\n\n        <span\n          role=\"checkbox\"\n          className={this._classNames.checkCover}\n          aria-checked={isSelected}\n          data-selection-toggle={true}\n        />\n      </FocusZone>\n    );\n  }\n\n  /**\n   * measure cell at index. and call the call back with the measured cell width when finish measure\n   *\n   * @param index - The cell index\n   * @param onMeasureDone - The call back function when finish measure\n   */\n  public measureCell(index: number, onMeasureDone: (width: number) => void): void {\n    const { columns = NO_COLUMNS } = this.props;\n    const column: IColumn = { ...columns[index] };\n\n    column.minWidth = 0;\n    column.maxWidth = 999999;\n\n    delete column.calculatedWidth;\n\n    this.setState({\n      columnMeasureInfo: {\n        index,\n        column,\n        onMeasureDone,\n      },\n    });\n  }\n\n  public focus(forceIntoFirstElement: boolean = false): boolean {\n    return !!this._focusZone.current && this._focusZone.current.focus(forceIntoFirstElement);\n  }\n\n  protected _onRenderCheck(props: IDetailsRowCheckProps) {\n    return <DetailsRowCheck {...props} />;\n  }\n\n  private _getSelectionState(props: IDetailsRowBaseProps): IDetailsRowSelectionState {\n    const { itemIndex, selection } = props;\n\n    return {\n      isSelected: !!selection && selection.isIndexSelected(itemIndex),\n      isSelectionModal: !!selection && !!selection.isModal && selection.isModal(),\n    };\n  }\n\n  private _onSelectionChanged = (): void => {\n    const selectionState = this._getSelectionState(this.props);\n\n    if (!shallowCompare(selectionState, this.state.selectionState)) {\n      this.setState({\n        selectionState: selectionState,\n      });\n    }\n  };\n\n  private _onRootRef = (focusZone: FocusZone): void => {\n    if (focusZone) {\n      // Need to resolve the actual DOM node, not the component.\n      // The element itself will be used for drag/drop and focusing.\n      this._root = ReactDOM.findDOMNode(focusZone) as HTMLElement;\n    } else {\n      this._root = undefined;\n    }\n  };\n\n  private _getRowDragDropOptions(): IDragDropOptions {\n    const { item, itemIndex, dragDropEvents, eventsToRegister } = this.props;\n    const options = {\n      eventMap: eventsToRegister,\n      selectionIndex: itemIndex,\n      context: { data: item, index: itemIndex },\n      canDrag: dragDropEvents!.canDrag,\n      canDrop: dragDropEvents!.canDrop,\n      onDragStart: dragDropEvents!.onDragStart,\n      updateDropState: this._updateDroppingState,\n      onDrop: dragDropEvents!.onDrop,\n      onDragEnd: dragDropEvents!.onDragEnd,\n      onDragOver: dragDropEvents!.onDragOver,\n    };\n\n    return options;\n  }\n\n  /**\n   * update isDropping state based on the input value, which is used to change style during drag and drop\n   *\n   * when change to true, that means drag enter. we will add default dropping class name\n   * or the custom dropping class name (return result from onDragEnter) to the root elemet.\n   *\n   * when change to false, that means drag leave. we will remove the dropping class name from root element.\n   *\n   * @param newValue - New isDropping state value\n   * @param event - The event trigger dropping state change which can be dragenter, dragleave etc\n   */\n  private _updateDroppingState = (newValue: boolean, event: DragEvent): void => {\n    const { isDropping } = this.state;\n    const { dragDropEvents, item } = this.props;\n\n    if (!newValue) {\n      if (dragDropEvents!.onDragLeave) {\n        dragDropEvents!.onDragLeave(item, event);\n      }\n    } else if (dragDropEvents!.onDragEnter) {\n      this._droppingClassNames = dragDropEvents!.onDragEnter(item, event);\n    }\n\n    if (isDropping !== newValue) {\n      this.setState({ isDropping: newValue });\n    }\n  };\n}\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}