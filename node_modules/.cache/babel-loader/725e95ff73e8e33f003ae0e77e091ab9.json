{"ast":null,"code":"import { __assign, __spreadArrays } from \"tslib\";\nimport * as React from 'react';\nimport { useConst, usePrevious } from '@uifabric/react-hooks';\nimport { mergeAriaAttributeValues } from '../../Utilities';\nimport { KeytipManager, mergeOverflows, sequencesToID, getAriaDescribedBy } from '../../utilities/keytips/index';\nexport function useKeytipData(options) {\n  var _a, _b;\n\n  var uniqueId = React.useRef();\n  var keytipProps = options.keytipProps ? __assign({\n    disabled: options.disabled\n  }, options.keytipProps) : undefined;\n  var keytipManager = useConst(KeytipManager.getInstance());\n  React.useEffect(function () {\n    // Register Keytip in KeytipManager\n    if (keytipProps) {\n      uniqueId.current = keytipManager.register(keytipProps);\n    }\n\n    return function () {\n      // Unregister Keytip in KeytipManager\n      keytipProps && keytipManager.unregister(keytipProps, uniqueId.current);\n    };\n  }, []);\n  var prevOptions = usePrevious(options);\n\n  if (uniqueId.current && keytipProps && (((_a = prevOptions) === null || _a === void 0 ? void 0 : _a.keytipProps) !== options.keytipProps || ((_b = prevOptions) === null || _b === void 0 ? void 0 : _b.disabled) !== options.disabled)) {\n    keytipManager.update(keytipProps, uniqueId.current);\n  }\n\n  var nativeKeytipProps = {\n    ariaDescribedBy: undefined,\n    targetElementAttributes: {},\n    executeElementAttributes: {}\n  };\n\n  if (keytipProps) {\n    nativeKeytipProps = getKtpAttrs(keytipManager, keytipProps, options.ariaDescribedBy);\n  }\n\n  return nativeKeytipProps;\n}\n/**\n * Gets the aria- and data- attributes to attach to the component\n * @param keytipProps - options for Keytip\n * @param describedByPrepend - ariaDescribedBy value to prepend\n */\n\nfunction getKtpAttrs(keytipManager, keytipProps, describedByPrepend) {\n  // Add the parent overflow sequence if necessary\n  var newKeytipProps = keytipManager.addParentOverflow(keytipProps); // Construct aria-describedby and data-ktp-id attributes\n\n  var ariaDescribedBy = mergeAriaAttributeValues(describedByPrepend, getAriaDescribedBy(newKeytipProps.keySequences));\n\n  var keySequences = __spreadArrays(newKeytipProps.keySequences);\n\n  if (newKeytipProps.overflowSetSequence) {\n    keySequences = mergeOverflows(keySequences, newKeytipProps.overflowSetSequence);\n  }\n\n  var ktpId = sequencesToID(keySequences);\n  return {\n    ariaDescribedBy: ariaDescribedBy,\n    targetElementAttributes: {\n      'data-ktp-target': ktpId\n    },\n    executeElementAttributes: {\n      'data-ktp-execute-target': ktpId\n    }\n  };\n}","map":{"version":3,"sources":["components/KeytipData/useKeytipData.ts"],"names":[],"mappings":";AAAA,OAAO,KAAK,KAAZ,MAAuB,OAAvB;AACA,SAAS,QAAT,EAAmB,WAAnB,QAAsC,uBAAtC;AACA,SAAS,wBAAT,QAAyC,iBAAzC;AAGA,SAAS,aAAT,EAAwB,cAAxB,EAAwC,aAAxC,EAAuD,kBAAvD,QAAiF,+BAAjF;AAUA,OAAM,SAAU,aAAV,CAAwB,OAAxB,EAAkD;;;AACtD,MAAM,QAAQ,GAAG,KAAK,CAAC,MAAN,EAAjB;AACA,MAAM,WAAW,GAA6B,OAAO,CAAC,WAAR,GAC3C,QAAA,CAAA;AACG,IAAA,QAAQ,EAAE,OAAO,CAAC;AADrB,GAAA,EAEM,OAAO,CAAC,WAFd,CAD2C,GAK1C,SALJ;AAOA,MAAM,aAAa,GAAG,QAAQ,CAAgB,aAAa,CAAC,WAAd,EAAhB,CAA9B;AAEA,EAAA,KAAK,CAAC,SAAN,CAAgB,YAAA;AACd;AACA,QAAI,WAAJ,EAAiB;AACf,MAAA,QAAQ,CAAC,OAAT,GAAmB,aAAa,CAAC,QAAd,CAAuB,WAAvB,CAAnB;AACD;;AAED,WAAO,YAAA;AACL;AACA,MAAA,WAAW,IAAI,aAAa,CAAC,UAAd,CAAyB,WAAzB,EAAsC,QAAQ,CAAC,OAA/C,CAAf;AACD,KAHD;AAID,GAVD,EAUG,EAVH;AAYA,MAAM,WAAW,GAAG,WAAW,CAAC,OAAD,CAA/B;;AAEA,MACE,QAAQ,CAAC,OAAT,IACA,WADA,KAEC,CAAA,CAAA,EAAA,GAAA,WAAA,MAAW,IAAX,IAAW,EAAA,KAAA,KAAA,CAAX,GAAW,KAAA,CAAX,GAAW,EAAA,CAAE,WAAb,MAA6B,OAAO,CAAC,WAArC,IAAoD,CAAA,CAAA,EAAA,GAAA,WAAA,MAAW,IAAX,IAAW,EAAA,KAAA,KAAA,CAAX,GAAW,KAAA,CAAX,GAAW,EAAA,CAAE,QAAb,MAA0B,OAAO,CAAC,QAFvF,CADF,EAIE;AACA,IAAA,aAAa,CAAC,MAAd,CAAqB,WAArB,EAAkC,QAAQ,CAAC,OAA3C;AACD;;AAED,MAAI,iBAAiB,GAAgB;AACnC,IAAA,eAAe,EAAE,SADkB;AAEnC,IAAA,uBAAuB,EAAE,EAFU;AAGnC,IAAA,wBAAwB,EAAE;AAHS,GAArC;;AAMA,MAAI,WAAJ,EAAiB;AACf,IAAA,iBAAiB,GAAG,WAAW,CAAC,aAAD,EAAgB,WAAhB,EAA6B,OAAO,CAAC,eAArC,CAA/B;AACD;;AAED,SAAO,iBAAP;AACD;AAED;;;;;;AAKA,SAAS,WAAT,CACE,aADF,EAEE,WAFF,EAGE,kBAHF,EAG6B;AAE3B;AACA,MAAM,cAAc,GAAG,aAAa,CAAC,iBAAd,CAAgC,WAAhC,CAAvB,CAH2B,CAK3B;;AACA,MAAM,eAAe,GAAG,wBAAwB,CAC9C,kBAD8C,EAE9C,kBAAkB,CAAC,cAAc,CAAC,YAAhB,CAF4B,CAAhD;;AAKA,MAAI,YAAY,GAAA,cAAA,CAAO,cAAc,CAAC,YAAtB,CAAhB;;AACA,MAAI,cAAc,CAAC,mBAAnB,EAAwC;AACtC,IAAA,YAAY,GAAG,cAAc,CAAC,YAAD,EAAe,cAAc,CAAC,mBAA9B,CAA7B;AACD;;AACD,MAAM,KAAK,GAAG,aAAa,CAAC,YAAD,CAA3B;AAEA,SAAO;AACL,IAAA,eAAe,EAAA,eADV;AAEL,IAAA,uBAAuB,EAAE;AACvB,yBAAmB;AADI,KAFpB;AAKL,IAAA,wBAAwB,EAAE;AACxB,iCAA2B;AADH;AALrB,GAAP;AASD","sourcesContent":["import * as React from 'react';\nimport { useConst, usePrevious } from '@uifabric/react-hooks';\nimport { mergeAriaAttributeValues } from '../../Utilities';\nimport { IKeytipDataProps } from './KeytipData.types';\nimport { IKeytipProps } from '../../Keytip';\nimport { KeytipManager, mergeOverflows, sequencesToID, getAriaDescribedBy } from '../../utilities/keytips/index';\n\nexport type KeytipDataOptions = IKeytipDataProps;\n\nexport interface IKeytipData {\n  ariaDescribedBy: string | undefined;\n  targetElementAttributes: { [key: string]: string | undefined };\n  executeElementAttributes: { [key: string]: string | undefined };\n}\n\nexport function useKeytipData(options: KeytipDataOptions): IKeytipData {\n  const uniqueId = React.useRef<string>();\n  const keytipProps: IKeytipProps | undefined = options.keytipProps\n    ? {\n        disabled: options.disabled,\n        ...options.keytipProps,\n      }\n    : undefined;\n\n  const keytipManager = useConst<KeytipManager>(KeytipManager.getInstance());\n\n  React.useEffect(() => {\n    // Register Keytip in KeytipManager\n    if (keytipProps) {\n      uniqueId.current = keytipManager.register(keytipProps);\n    }\n\n    return () => {\n      // Unregister Keytip in KeytipManager\n      keytipProps && keytipManager.unregister(keytipProps, uniqueId.current!);\n    };\n  }, []);\n\n  const prevOptions = usePrevious(options);\n\n  if (\n    uniqueId.current &&\n    keytipProps &&\n    (prevOptions?.keytipProps !== options.keytipProps || prevOptions?.disabled !== options.disabled)\n  ) {\n    keytipManager.update(keytipProps, uniqueId.current);\n  }\n\n  let nativeKeytipProps: IKeytipData = {\n    ariaDescribedBy: undefined,\n    targetElementAttributes: {},\n    executeElementAttributes: {},\n  };\n\n  if (keytipProps) {\n    nativeKeytipProps = getKtpAttrs(keytipManager, keytipProps, options.ariaDescribedBy);\n  }\n\n  return nativeKeytipProps;\n}\n\n/**\n * Gets the aria- and data- attributes to attach to the component\n * @param keytipProps - options for Keytip\n * @param describedByPrepend - ariaDescribedBy value to prepend\n */\nfunction getKtpAttrs(\n  keytipManager: KeytipManager,\n  keytipProps: IKeytipProps,\n  describedByPrepend?: string,\n): IKeytipData {\n  // Add the parent overflow sequence if necessary\n  const newKeytipProps = keytipManager.addParentOverflow(keytipProps);\n\n  // Construct aria-describedby and data-ktp-id attributes\n  const ariaDescribedBy = mergeAriaAttributeValues(\n    describedByPrepend,\n    getAriaDescribedBy(newKeytipProps.keySequences),\n  )!;\n\n  let keySequences = [...newKeytipProps.keySequences];\n  if (newKeytipProps.overflowSetSequence) {\n    keySequences = mergeOverflows(keySequences, newKeytipProps.overflowSetSequence);\n  }\n  const ktpId = sequencesToID(keySequences);\n\n  return {\n    ariaDescribedBy,\n    targetElementAttributes: {\n      'data-ktp-target': ktpId,\n    },\n    executeElementAttributes: {\n      'data-ktp-execute-target': ktpId,\n    },\n  };\n}\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}