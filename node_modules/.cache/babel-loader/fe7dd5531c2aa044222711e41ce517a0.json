{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport * as React from 'react';\nimport { initializeComponentRef, classNamesFunction, FocusRects } from '../../Utilities';\nimport { GroupedListSection } from './GroupedListSection';\nimport { List } from '../../List';\nimport { SelectionMode } from '../../utilities/selection/index';\nimport { DEFAULT_ROW_HEIGHTS } from '../DetailsList/DetailsRow.styles';\nvar getClassNames = classNamesFunction();\nvar ROW_HEIGHT = DEFAULT_ROW_HEIGHTS.rowHeight,\n    COMPACT_ROW_HEIGHT = DEFAULT_ROW_HEIGHTS.compactRowHeight;\n\nvar GroupedListBase =\n/** @class */\nfunction (_super) {\n  __extends(GroupedListBase, _super);\n\n  function GroupedListBase(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this._list = React.createRef();\n\n    _this._renderGroup = function (group, groupIndex) {\n      var _a = _this.props,\n          dragDropEvents = _a.dragDropEvents,\n          dragDropHelper = _a.dragDropHelper,\n          eventsToRegister = _a.eventsToRegister,\n          groupProps = _a.groupProps,\n          items = _a.items,\n          listProps = _a.listProps,\n          onRenderCell = _a.onRenderCell,\n          selectionMode = _a.selectionMode,\n          selection = _a.selection,\n          viewport = _a.viewport,\n          onShouldVirtualize = _a.onShouldVirtualize,\n          groups = _a.groups,\n          compact = _a.compact; // override group header/footer props as needed\n\n      var dividerProps = {\n        onToggleSelectGroup: _this._onToggleSelectGroup,\n        onToggleCollapse: _this._onToggleCollapse,\n        onToggleSummarize: _this._onToggleSummarize\n      };\n\n      var headerProps = __assign(__assign({}, groupProps.headerProps), dividerProps);\n\n      var showAllProps = __assign(__assign({}, groupProps.showAllProps), dividerProps);\n\n      var footerProps = __assign(__assign({}, groupProps.footerProps), dividerProps);\n\n      var groupNestingDepth = _this._getGroupNestingDepth();\n\n      if (!groupProps.showEmptyGroups && group && group.count === 0) {\n        return null;\n      }\n\n      return React.createElement(GroupedListSection, {\n        ref: 'group_' + groupIndex,\n        key: _this._getGroupKey(group, groupIndex),\n        dragDropEvents: dragDropEvents,\n        dragDropHelper: dragDropHelper,\n        eventsToRegister: eventsToRegister,\n        footerProps: footerProps,\n        getGroupItemLimit: groupProps && groupProps.getGroupItemLimit,\n        group: group,\n        groupIndex: groupIndex,\n        groupNestingDepth: groupNestingDepth,\n        groupProps: groupProps,\n        headerProps: headerProps,\n        listProps: listProps,\n        items: items,\n        onRenderCell: onRenderCell,\n        onRenderGroupHeader: groupProps.onRenderHeader,\n        onRenderGroupShowAll: groupProps.onRenderShowAll,\n        onRenderGroupFooter: groupProps.onRenderFooter,\n        selectionMode: selectionMode,\n        selection: selection,\n        showAllProps: showAllProps,\n        viewport: viewport,\n        onShouldVirtualize: onShouldVirtualize,\n        groupedListClassNames: _this._classNames,\n        groups: groups,\n        compact: compact\n      });\n    };\n\n    _this._getDefaultGroupItemLimit = function (group) {\n      return group.count;\n    };\n\n    _this._getGroupItemLimit = function (group) {\n      var groupProps = _this.props.groupProps;\n      var getGroupItemLimit = groupProps && groupProps.getGroupItemLimit ? groupProps.getGroupItemLimit : _this._getDefaultGroupItemLimit;\n      return getGroupItemLimit(group);\n    };\n\n    _this._getGroupHeight = function (group) {\n      var rowHeight = _this.props.compact ? COMPACT_ROW_HEIGHT : ROW_HEIGHT;\n      return rowHeight + (group.isCollapsed ? 0 : rowHeight * _this._getGroupItemLimit(group));\n    };\n\n    _this._getPageHeight = function (itemIndex) {\n      var groups = _this.state.groups;\n      var _a = _this.props.getGroupHeight,\n          getGroupHeight = _a === void 0 ? _this._getGroupHeight : _a;\n      var pageGroup = groups && groups[itemIndex];\n\n      if (pageGroup) {\n        return getGroupHeight(pageGroup, itemIndex);\n      } else {\n        return 0;\n      }\n    };\n\n    _this._onToggleCollapse = function (group) {\n      var groupProps = _this.props.groupProps;\n      var onToggleCollapse = groupProps && groupProps.headerProps && groupProps.headerProps.onToggleCollapse;\n\n      if (group) {\n        if (onToggleCollapse) {\n          onToggleCollapse(group);\n        }\n\n        group.isCollapsed = !group.isCollapsed;\n\n        _this._updateIsSomeGroupExpanded();\n\n        _this.forceUpdate();\n      }\n    };\n\n    _this._onToggleSelectGroup = function (group) {\n      var _a = _this.props,\n          selection = _a.selection,\n          selectionMode = _a.selectionMode;\n\n      if (group && selection && selectionMode === SelectionMode.multiple) {\n        selection.toggleRangeSelected(group.startIndex, group.count);\n      }\n    };\n\n    _this._onToggleSummarize = function (group) {\n      var groupProps = _this.props.groupProps;\n      var onToggleSummarize = groupProps && groupProps.showAllProps && groupProps.showAllProps.onToggleSummarize;\n\n      if (onToggleSummarize) {\n        onToggleSummarize(group);\n      } else {\n        if (group) {\n          group.isShowingAll = !group.isShowingAll;\n        }\n\n        _this.forceUpdate();\n      }\n    };\n\n    _this._getPageSpecification = function (itemIndex) {\n      var groups = _this.state.groups;\n      var pageGroup = groups && groups[itemIndex];\n      return {\n        key: pageGroup && pageGroup.key\n      };\n    };\n\n    initializeComponentRef(_this);\n    _this._isSomeGroupExpanded = _this._computeIsSomeGroupExpanded(props.groups);\n    _this.state = {\n      lastWidth: 0,\n      groups: props.groups\n    };\n    return _this;\n  }\n\n  GroupedListBase.prototype.scrollToIndex = function (index, measureItem, scrollToMode) {\n    if (this._list.current) {\n      this._list.current.scrollToIndex(index, measureItem, scrollToMode);\n    }\n  };\n\n  GroupedListBase.prototype.getStartItemIndexInView = function () {\n    return this._list.current.getStartItemIndexInView() || 0;\n  }; // tslint:disable-next-line function-name\n\n\n  GroupedListBase.prototype.UNSAFE_componentWillReceiveProps = function (newProps) {\n    var _a = this.props,\n        groups = _a.groups,\n        selectionMode = _a.selectionMode,\n        compact = _a.compact;\n    var shouldForceUpdates = false;\n\n    if (newProps.groups !== groups) {\n      this.setState({\n        groups: newProps.groups\n      });\n      shouldForceUpdates = true;\n    }\n\n    if (newProps.selectionMode !== selectionMode || newProps.compact !== compact) {\n      shouldForceUpdates = true;\n    }\n\n    if (shouldForceUpdates) {\n      this._forceListUpdates();\n    }\n  };\n\n  GroupedListBase.prototype.componentDidMount = function () {\n    var _a = this.props,\n        groupProps = _a.groupProps,\n        _b = _a.groups,\n        groups = _b === void 0 ? [] : _b;\n\n    if (groupProps && groupProps.isAllGroupsCollapsed) {\n      this._setGroupsCollapsedState(groups, groupProps.isAllGroupsCollapsed);\n    }\n  };\n\n  GroupedListBase.prototype.render = function () {\n    var _a = this.props,\n        className = _a.className,\n        usePageCache = _a.usePageCache,\n        onShouldVirtualize = _a.onShouldVirtualize,\n        theme = _a.theme,\n        styles = _a.styles,\n        compact = _a.compact,\n        _b = _a.listProps,\n        listProps = _b === void 0 ? {} : _b;\n    var groups = this.state.groups;\n    this._classNames = getClassNames(styles, {\n      theme: theme,\n      className: className,\n      compact: compact\n    });\n    var version = listProps.version;\n    return React.createElement(\"div\", {\n      className: this._classNames.root,\n      \"data-automationid\": \"GroupedList\",\n      \"data-is-scrollable\": \"false\",\n      role: \"presentation\"\n    }, React.createElement(FocusRects, null), !groups ? this._renderGroup(undefined, 0) : React.createElement(List, {\n      ref: this._list,\n      role: \"presentation\",\n      items: groups,\n      onRenderCell: this._renderGroup,\n      getItemCountForPage: this._returnOne,\n      getPageHeight: this._getPageHeight,\n      getPageSpecification: this._getPageSpecification,\n      usePageCache: usePageCache,\n      onShouldVirtualize: onShouldVirtualize,\n      version: version\n    }));\n  };\n\n  GroupedListBase.prototype.forceUpdate = function () {\n    _super.prototype.forceUpdate.call(this);\n\n    this._forceListUpdates();\n  };\n\n  GroupedListBase.prototype.toggleCollapseAll = function (allCollapsed) {\n    var _a = this.state.groups,\n        groups = _a === void 0 ? [] : _a;\n    var groupProps = this.props.groupProps;\n    var onToggleCollapseAll = groupProps && groupProps.onToggleCollapseAll;\n\n    if (groups.length > 0) {\n      if (onToggleCollapseAll) {\n        onToggleCollapseAll(allCollapsed);\n      }\n\n      this._setGroupsCollapsedState(groups, allCollapsed);\n\n      this._updateIsSomeGroupExpanded();\n\n      this.forceUpdate();\n    }\n  };\n\n  GroupedListBase.prototype._setGroupsCollapsedState = function (groups, isCollapsed) {\n    for (var groupIndex = 0; groupIndex < groups.length; groupIndex++) {\n      groups[groupIndex].isCollapsed = isCollapsed;\n    }\n  };\n\n  GroupedListBase.prototype._returnOne = function () {\n    return 1;\n  };\n\n  GroupedListBase.prototype._getGroupKey = function (group, index) {\n    return 'group-' + (group && group.key ? group.key : String(index));\n  };\n\n  GroupedListBase.prototype._getGroupNestingDepth = function () {\n    var groups = this.state.groups;\n    var level = 0;\n    var groupsInLevel = groups;\n\n    while (groupsInLevel && groupsInLevel.length > 0) {\n      level++;\n      groupsInLevel = groupsInLevel[0].children;\n    }\n\n    return level;\n  };\n\n  GroupedListBase.prototype._forceListUpdates = function (groups) {\n    groups = groups || this.state.groups;\n    var groupCount = groups ? groups.length : 1;\n\n    if (this._list.current) {\n      this._list.current.forceUpdate();\n\n      for (var i = 0; i < groupCount; i++) {\n        var group = this._list.current.refs['group_' + String(i)];\n\n        if (group) {\n          group.forceListUpdate();\n        }\n      }\n    } else {\n      var group = this.refs['group_' + String(0)];\n\n      if (group) {\n        group.forceListUpdate();\n      }\n    }\n  };\n\n  GroupedListBase.prototype._computeIsSomeGroupExpanded = function (groups) {\n    var _this = this;\n\n    return !!(groups && groups.some(function (group) {\n      return group.children ? _this._computeIsSomeGroupExpanded(group.children) : !group.isCollapsed;\n    }));\n  };\n\n  GroupedListBase.prototype._updateIsSomeGroupExpanded = function () {\n    var groups = this.state.groups;\n    var onGroupExpandStateChanged = this.props.onGroupExpandStateChanged;\n\n    var newIsSomeGroupExpanded = this._computeIsSomeGroupExpanded(groups);\n\n    if (this._isSomeGroupExpanded !== newIsSomeGroupExpanded) {\n      if (onGroupExpandStateChanged) {\n        onGroupExpandStateChanged(newIsSomeGroupExpanded);\n      }\n\n      this._isSomeGroupExpanded = newIsSomeGroupExpanded;\n    }\n  };\n\n  GroupedListBase.defaultProps = {\n    selectionMode: SelectionMode.multiple,\n    isHeaderVisible: true,\n    groupProps: {},\n    compact: false\n  };\n  return GroupedListBase;\n}(React.Component);\n\nexport { GroupedListBase };","map":{"version":3,"sources":["components/GroupedList/GroupedList.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { IProcessedStyleSet } from '../../Styling';\nimport { initializeComponentRef, classNamesFunction, FocusRects } from '../../Utilities';\nimport {\n  IGroupedList,\n  IGroupedListProps,\n  IGroup,\n  IGroupedListStyleProps,\n  IGroupedListStyles,\n} from './GroupedList.types';\nimport { GroupedListSection } from './GroupedListSection';\nimport { List, ScrollToMode, IListProps } from '../../List';\nimport { SelectionMode } from '../../utilities/selection/index';\nimport { DEFAULT_ROW_HEIGHTS } from '../DetailsList/DetailsRow.styles';\nimport { IGroupHeaderProps } from './GroupHeader';\nimport { IGroupShowAllProps } from './GroupShowAll.styles';\nimport { IGroupFooterProps } from './GroupFooter.types';\n\nconst getClassNames = classNamesFunction<IGroupedListStyleProps, IGroupedListStyles>();\nconst { rowHeight: ROW_HEIGHT, compactRowHeight: COMPACT_ROW_HEIGHT } = DEFAULT_ROW_HEIGHTS;\n\nexport interface IGroupedListState {\n  lastWidth?: number;\n  lastSelectionMode?: SelectionMode;\n  groups?: IGroup[];\n}\n\nexport class GroupedListBase extends React.Component<IGroupedListProps, IGroupedListState> implements IGroupedList {\n  public static defaultProps = {\n    selectionMode: SelectionMode.multiple,\n    isHeaderVisible: true,\n    groupProps: {},\n    compact: false,\n  };\n\n  public refs: {\n    [key: string]: React.ReactInstance;\n  };\n\n  private _classNames: IProcessedStyleSet<IGroupedListStyles>;\n\n  private _list = React.createRef<List>();\n\n  private _isSomeGroupExpanded: boolean;\n\n  constructor(props: IGroupedListProps) {\n    super(props);\n\n    initializeComponentRef(this);\n\n    this._isSomeGroupExpanded = this._computeIsSomeGroupExpanded(props.groups);\n\n    this.state = {\n      lastWidth: 0,\n      groups: props.groups,\n    };\n  }\n\n  public scrollToIndex(index: number, measureItem?: (itemIndex: number) => number, scrollToMode?: ScrollToMode): void {\n    if (this._list.current) {\n      this._list.current.scrollToIndex(index, measureItem, scrollToMode);\n    }\n  }\n\n  public getStartItemIndexInView(): number {\n    return this._list.current!.getStartItemIndexInView() || 0;\n  }\n\n  // tslint:disable-next-line function-name\n  public UNSAFE_componentWillReceiveProps(newProps: IGroupedListProps): void {\n    const { groups, selectionMode, compact } = this.props;\n    let shouldForceUpdates = false;\n\n    if (newProps.groups !== groups) {\n      this.setState({ groups: newProps.groups });\n      shouldForceUpdates = true;\n    }\n\n    if (newProps.selectionMode !== selectionMode || newProps.compact !== compact) {\n      shouldForceUpdates = true;\n    }\n\n    if (shouldForceUpdates) {\n      this._forceListUpdates();\n    }\n  }\n\n  public componentDidMount() {\n    const { groupProps, groups = [] } = this.props;\n\n    if (groupProps && groupProps.isAllGroupsCollapsed) {\n      this._setGroupsCollapsedState(groups, groupProps.isAllGroupsCollapsed);\n    }\n  }\n\n  public render(): JSX.Element {\n    const { className, usePageCache, onShouldVirtualize, theme, styles, compact, listProps = {} } = this.props;\n    const { groups } = this.state;\n    this._classNames = getClassNames(styles, {\n      theme: theme!,\n      className,\n      compact: compact,\n    });\n\n    const { version } = listProps;\n\n    return (\n      <div\n        className={this._classNames.root}\n        data-automationid=\"GroupedList\"\n        data-is-scrollable=\"false\"\n        role=\"presentation\"\n      >\n        <FocusRects />\n        {!groups ? (\n          this._renderGroup(undefined, 0)\n        ) : (\n          <List\n            ref={this._list}\n            role=\"presentation\"\n            items={groups}\n            onRenderCell={this._renderGroup}\n            getItemCountForPage={this._returnOne}\n            getPageHeight={this._getPageHeight}\n            getPageSpecification={this._getPageSpecification}\n            usePageCache={usePageCache}\n            onShouldVirtualize={onShouldVirtualize}\n            version={version}\n          />\n        )}\n      </div>\n    );\n  }\n\n  public forceUpdate() {\n    super.forceUpdate();\n    this._forceListUpdates();\n  }\n\n  public toggleCollapseAll(allCollapsed: boolean): void {\n    const { groups = [] } = this.state;\n    const { groupProps } = this.props;\n    const onToggleCollapseAll = groupProps && groupProps.onToggleCollapseAll;\n\n    if (groups.length > 0) {\n      if (onToggleCollapseAll) {\n        onToggleCollapseAll(allCollapsed);\n      }\n\n      this._setGroupsCollapsedState(groups, allCollapsed);\n\n      this._updateIsSomeGroupExpanded();\n\n      this.forceUpdate();\n    }\n  }\n\n  private _setGroupsCollapsedState(groups: IGroup[], isCollapsed: boolean): void {\n    for (let groupIndex = 0; groupIndex < groups.length; groupIndex++) {\n      groups[groupIndex].isCollapsed = isCollapsed;\n    }\n  }\n\n  private _renderGroup = (group: IGroup | undefined, groupIndex: number): React.ReactNode => {\n    const {\n      dragDropEvents,\n      dragDropHelper,\n      eventsToRegister,\n      groupProps,\n      items,\n      listProps,\n      onRenderCell,\n      selectionMode,\n      selection,\n      viewport,\n      onShouldVirtualize,\n      groups,\n      compact,\n    } = this.props;\n\n    // override group header/footer props as needed\n    const dividerProps = {\n      onToggleSelectGroup: this._onToggleSelectGroup,\n      onToggleCollapse: this._onToggleCollapse,\n      onToggleSummarize: this._onToggleSummarize,\n    };\n\n    const headerProps: IGroupHeaderProps = { ...groupProps!.headerProps, ...dividerProps };\n    const showAllProps: IGroupShowAllProps = { ...groupProps!.showAllProps, ...dividerProps };\n    const footerProps: IGroupFooterProps = { ...groupProps!.footerProps, ...dividerProps };\n    const groupNestingDepth = this._getGroupNestingDepth();\n\n    if (!groupProps!.showEmptyGroups && group && group.count === 0) {\n      return null;\n    }\n\n    return (\n      <GroupedListSection\n        ref={'group_' + groupIndex}\n        key={this._getGroupKey(group, groupIndex)}\n        dragDropEvents={dragDropEvents}\n        dragDropHelper={dragDropHelper}\n        eventsToRegister={eventsToRegister}\n        footerProps={footerProps}\n        getGroupItemLimit={groupProps && groupProps.getGroupItemLimit}\n        group={group}\n        groupIndex={groupIndex}\n        groupNestingDepth={groupNestingDepth}\n        groupProps={groupProps}\n        headerProps={headerProps}\n        listProps={listProps}\n        items={items}\n        onRenderCell={onRenderCell}\n        onRenderGroupHeader={groupProps!.onRenderHeader}\n        onRenderGroupShowAll={groupProps!.onRenderShowAll}\n        onRenderGroupFooter={groupProps!.onRenderFooter}\n        selectionMode={selectionMode}\n        selection={selection}\n        showAllProps={showAllProps}\n        viewport={viewport}\n        onShouldVirtualize={onShouldVirtualize}\n        groupedListClassNames={this._classNames}\n        groups={groups}\n        compact={compact}\n      />\n    );\n  };\n\n  private _returnOne(): number {\n    return 1;\n  }\n\n  private _getDefaultGroupItemLimit = (group: IGroup): number => {\n    return group.count;\n  };\n\n  private _getGroupItemLimit = (group: IGroup): number => {\n    const { groupProps } = this.props;\n    const getGroupItemLimit =\n      groupProps && groupProps.getGroupItemLimit ? groupProps.getGroupItemLimit : this._getDefaultGroupItemLimit;\n\n    return getGroupItemLimit(group);\n  };\n\n  private _getGroupHeight = (group: IGroup): number => {\n    const rowHeight = this.props.compact ? COMPACT_ROW_HEIGHT : ROW_HEIGHT;\n\n    return rowHeight + (group.isCollapsed ? 0 : rowHeight * this._getGroupItemLimit(group));\n  };\n\n  private _getPageHeight: IListProps['getPageHeight'] = (itemIndex: number) => {\n    const { groups } = this.state;\n    const { getGroupHeight = this._getGroupHeight } = this.props;\n    const pageGroup = groups && groups[itemIndex];\n\n    if (pageGroup) {\n      return getGroupHeight(pageGroup, itemIndex);\n    } else {\n      return 0;\n    }\n  };\n\n  private _getGroupKey(group: IGroup | undefined, index: number): string {\n    return 'group-' + (group && group.key ? group.key : String(index));\n  }\n\n  private _getGroupNestingDepth(): number {\n    const { groups } = this.state;\n    let level = 0;\n    let groupsInLevel = groups;\n\n    while (groupsInLevel && groupsInLevel.length > 0) {\n      level++;\n      groupsInLevel = groupsInLevel[0].children;\n    }\n\n    return level;\n  }\n\n  private _onToggleCollapse = (group: IGroup): void => {\n    const { groupProps } = this.props;\n    const onToggleCollapse = groupProps && groupProps.headerProps && groupProps.headerProps.onToggleCollapse;\n\n    if (group) {\n      if (onToggleCollapse) {\n        onToggleCollapse(group);\n      }\n\n      group.isCollapsed = !group.isCollapsed;\n      this._updateIsSomeGroupExpanded();\n      this.forceUpdate();\n    }\n  };\n\n  private _onToggleSelectGroup = (group: IGroup): void => {\n    const { selection, selectionMode } = this.props;\n\n    if (group && selection && selectionMode === SelectionMode.multiple) {\n      selection.toggleRangeSelected(group.startIndex, group.count);\n    }\n  };\n\n  private _forceListUpdates(groups?: IGroup[]): void {\n    groups = groups || this.state.groups;\n\n    const groupCount = groups ? groups.length : 1;\n\n    if (this._list.current) {\n      this._list.current.forceUpdate();\n\n      for (let i = 0; i < groupCount; i++) {\n        const group = this._list.current.refs['group_' + String(i)] as GroupedListSection;\n        if (group) {\n          group.forceListUpdate();\n        }\n      }\n    } else {\n      const group = this.refs['group_' + String(0)] as GroupedListSection;\n      if (group) {\n        group.forceListUpdate();\n      }\n    }\n  }\n\n  private _onToggleSummarize = (group: IGroup): void => {\n    const { groupProps } = this.props;\n    const onToggleSummarize = groupProps && groupProps.showAllProps && groupProps.showAllProps.onToggleSummarize;\n\n    if (onToggleSummarize) {\n      onToggleSummarize(group);\n    } else {\n      if (group) {\n        group.isShowingAll = !group.isShowingAll;\n      }\n\n      this.forceUpdate();\n    }\n  };\n\n  private _getPageSpecification = (\n    itemIndex: number,\n  ): {\n    key?: string;\n  } => {\n    const groups = this.state.groups;\n    const pageGroup = groups && groups[itemIndex];\n    return {\n      key: pageGroup && pageGroup.key,\n    };\n  };\n\n  private _computeIsSomeGroupExpanded(groups: IGroup[] | undefined): boolean {\n    return !!(\n      groups &&\n      groups.some(group => (group.children ? this._computeIsSomeGroupExpanded(group.children) : !group.isCollapsed))\n    );\n  }\n\n  private _updateIsSomeGroupExpanded(): void {\n    const { groups } = this.state;\n    const { onGroupExpandStateChanged } = this.props;\n\n    const newIsSomeGroupExpanded = this._computeIsSomeGroupExpanded(groups);\n    if (this._isSomeGroupExpanded !== newIsSomeGroupExpanded) {\n      if (onGroupExpandStateChanged) {\n        onGroupExpandStateChanged(newIsSomeGroupExpanded);\n      }\n      this._isSomeGroupExpanded = newIsSomeGroupExpanded;\n    }\n  }\n}\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}